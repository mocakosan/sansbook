{"ast":null,"code":"var _this = this,\n  _jsxFileName = \"/Users/js/Desktop/sansbook/pages/profile.js\",\n  _s = $RefreshSig$();\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport AppLayout from \"../components/AppLayout\";\nimport Head from \"next/head\";\nimport NicknameEditForm from \"../components/NicknameEditForm\";\nimport FollowList from \"../components/FollowList\";\nimport { useSelector } from \"react-redux\";\nimport { useEffect, useState } from \"react\";\nimport Router from \"next/router\";\nimport useSWR from \"swr\";\nimport axios from \"axios\";\nvar fetcher = function fetcher(url) {\n  return axios.get(url, {\n    withCredentials: true\n  }).then(function (result) {\n    return result.data;\n  });\n};\nvar Profile = function Profile() {\n  _s();\n  var _useState = useState(3),\n    followingsLimit = _useState[0],\n    setFollowingsLimit = _useState[1];\n  var _useState2 = useState(3),\n    followersLimit = _useState2[0],\n    setFollowersLimit = _useState2[1];\n  var _useSWR = useSWR(\"http://localhost:3065/user/followers?limit=\".concat(followersLimit), fetcher),\n    followersData = _useSWR.data,\n    followerError = _useSWR.error;\n  var _useSWR2 = useSWR(\"http://localhost:3065/user/followings?limit=\".concat(followingsLimit), fetcher),\n    followingsData = _useSWR2.data,\n    followingError = _useSWR2.error;\n  var _useSelector = useSelector(function (state) {\n      return state.user;\n    }),\n    me = _useSelector.me;\n  // useEffect(() => {\n  //   dispatch({\n  //     type: LOAD_FOLLOWINGS_REQUEST,\n  //   });\n  //   dispatch({\n  //     type: LOAD_FOLLOWERS_REQUEST,\n  //   });\n  // }, []);\n  console.log(\"@@@@@@\", me);\n  useEffect(function () {\n    if (!(me && me.id)) {\n      Router.push(\"/\");\n    }\n  }, [me && me.id]);\n  var loadMoreFollowers = useCallback(function () {\n    setFollowersLimit(function (prev) {\n      return prev + 3;\n    });\n  }, []);\n  var loadMoreFollowings = useCallback(function () {\n    setFollowingsLimit(function (prev) {\n      return prev + 3;\n    });\n  }, []);\n  if (!me) {\n    return \"내정보 로딩중\";\n  }\n  if (followerError || followingError) {\n    console.error(followerError || followingError);\n    return \"팔로잉/팔로워 로딩 중 에러가 발생했습니다.\";\n  }\n  return __jsx(React.Fragment, null, __jsx(Head, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }\n  }, __jsx(\"title\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 9\n    }\n  }, \"\\uB0B4\\uD504\\uB85C\\uD544 | Sansbook \")), __jsx(AppLayout, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }\n  }, __jsx(NicknameEditForm, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 9\n    }\n  }), __jsx(FollowList, {\n    header: \"\\uD314\\uB85C\\uC789 \\uBAA9\\uB85D\",\n    data: followingsData,\n    onClickMore: loadMoreFollowings,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 9\n    }\n  }), __jsx(FollowList, {\n    header: \"\\uD314\\uB85C\\uC6CC \\uBAA9\\uB85D\",\n    data: followersData,\n    onClickMore: loadMoreFollowers,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 9\n    }\n  })));\n};\n\n//SSR : next전용 서버사이드 렌더링 = 사용\n_s(Profile, \"TNaPMnHP8j+1PA/jQoeWbQVFMb4=\", false, function () {\n  return [useSWR, useSWR, useSelector];\n});\n_c = Profile;\nexport var __N_SSP = true;\nexport default Profile;\nvar _c;\n$RefreshReg$(_c, \"Profile\");","map":{"version":3,"names":["AppLayout","Head","NicknameEditForm","FollowList","useSelector","useEffect","useState","Router","useSWR","axios","fetcher","url","get","withCredentials","then","result","data","Profile","_s","_useState","followingsLimit","setFollowingsLimit","_useState2","followersLimit","setFollowersLimit","_useSWR","concat","followersData","followerError","error","_useSWR2","followingsData","followingError","_useSelector","state","user","me","console","log","id","push","loadMoreFollowers","useCallback","prev","loadMoreFollowings","__jsx","React","Fragment","__self","_this","__source","fileName","_jsxFileName","lineNumber","columnNumber","header","onClickMore","_c","__N_SSP","$RefreshReg$"],"sources":["/Users/js/Desktop/sansbook/pages/profile.js"],"sourcesContent":["import AppLayout from \"../components/AppLayout\";\nimport Head from \"next/head\";\nimport NicknameEditForm from \"../components/NicknameEditForm\";\nimport FollowList from \"../components/FollowList\";\nimport { useSelector } from \"react-redux\";\nimport { useEffect, useState } from \"react\";\nimport Router from \"next/router\";\nimport { LOAD_MY_INFO_REQUEST } from \"../reducers/user\";\nimport useSWR from \"swr\";\nimport axios from \"axios\";\nimport wrapper from \"../store/configureStore\";\nimport { END } from \"redux-saga\";\n\nconst fetcher = (url) =>\n  axios.get(url, { withCredentials: true }).then((result) => result.data);\n\nconst Profile = () => {\n  const [followingsLimit, setFollowingsLimit] = useState(3);\n  const [followersLimit, setFollowersLimit] = useState(3);\n  const { data: followersData, error: followerError } = useSWR(\n    `http://localhost:3065/user/followers?limit=${followersLimit}`,\n    fetcher\n  );\n  const { data: followingsData, error: followingError } = useSWR(\n    `http://localhost:3065/user/followings?limit=${followingsLimit}`,\n    fetcher\n  );\n\n  const { me } = useSelector((state) => state.user);\n  // useEffect(() => {\n  //   dispatch({\n  //     type: LOAD_FOLLOWINGS_REQUEST,\n  //   });\n  //   dispatch({\n  //     type: LOAD_FOLLOWERS_REQUEST,\n  //   });\n  // }, []);\n  console.log(\"@@@@@@\", me);\n  useEffect(() => {\n    if (!(me && me.id)) {\n      Router.push(\"/\");\n    }\n  }, [me && me.id]);\n\n  const loadMoreFollowers = useCallback(() => {\n    setFollowersLimit((prev) => prev + 3);\n  }, []);\n\n  const loadMoreFollowings = useCallback(() => {\n    setFollowingsLimit((prev) => prev + 3);\n  }, []);\n\n  if (!me) {\n    return \"내정보 로딩중\";\n  }\n\n  if (followerError || followingError) {\n    console.error(followerError || followingError);\n    return \"팔로잉/팔로워 로딩 중 에러가 발생했습니다.\";\n  }\n\n  return (\n    <>\n      <Head>\n        <title>내프로필 | Sansbook </title>\n      </Head>\n      <AppLayout>\n        <NicknameEditForm />\n        <FollowList\n          header=\"팔로잉 목록\"\n          data={followingsData}\n          onClickMore={loadMoreFollowings}\n        />\n        <FollowList\n          header=\"팔로워 목록\"\n          data={followersData}\n          onClickMore={loadMoreFollowers}\n        />\n      </AppLayout>\n    </>\n  );\n};\n\n//SSR : next전용 서버사이드 렌더링 = 사용\nexport const getServerSideProps = wrapper.getServerSideProps(\n  (store) => async (context) => {\n    const cookie = context.req ? context.req.headers.cookie : \"\";\n    axios.defaults.headers.Cookie = \"\";\n    if (context.req && cookie) {\n      //쿠키를 써서 요청을 보냈을떄만 잠시 보관해두었다가 쿠키 안써서 요청보낼떄는 서버에서 공유하고 있는 쿠키를 제거하는\n      axios.defaults.headers.Cookie = cookie; //잘못하면 내 뒤로 로그인하는 사람이 내쿠키를 공유해서 내정보로 로그인하는 현상이 일어나서 해두는 조치\n    }\n    store.dispatch({\n      type: LOAD_MY_INFO_REQUEST,\n    });\n\n    store.dispatch(END);\n    await store.sagaTask.toPromise();\n    return { props: {} };\n  }\n);\n\nexport default Profile;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}